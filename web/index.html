<!doctype html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vemra - Minskar administration f√∂r m√§klare</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body class="sidebar-open view-objects">
    <aside class="sidebar">
        <a class="sidebar__logo" href="#" data-view="objects" aria-label="Till startsidan">
            <img src="/assets/vemra-logo.svg" alt="Vemra">
        </a>
        <nav>
            <a class="sidebar__item active" href="#" data-view="objects">
                <span class="icon">üìÇ</span>
                <span class="sidebar__label">Mina objekt</span>
            </a>
            <a class="sidebar__item" href="#" data-view="generator">
                <span class="icon">ü™Ñ</span>
                <span class="sidebar__label">Annonsgenerator</span>
            </a>
            <a class="sidebar__item" href="#" data-view="stats">
                <span class="icon">üìä</span>
                <span class="sidebar__label">Statistik</span>
            </a>
            <a class="sidebar__item" href="#" data-view="vision">
                <span class="icon">üñº</span>
                <span class="sidebar__label">Bildstudio</span>
            </a>
            <a class="sidebar__item" href="#" data-view="annuals">
                <span class="icon">üìë</span>
                <span class="sidebar__label">√Örsredovisning</span>
            </a>
            <a class="sidebar__item" href="#" data-view="templates">
                <span class="icon">üß©</span>
                <span class="sidebar__label">Mallar</span>
            </a>
            <a class="sidebar__item" href="#" data-view="settings">
                <span class="icon">‚öôÔ∏è</span>
                <span class="sidebar__label">Inst√§llningar</span>
            </a>
        </nav>
        <div class="sidebar__brand sidebar__footer">
            <div class="sidebar__brand-email" id="user-email-sidebar">Ej inloggad</div>
            <button class="ghost sidebar__logout" id="logout-btn" type="button">Logga ut</button>
        </div>
    </aside>

    <div class="shell">
        <header class="topbar">
            <div class="topbar__left">
                <button class="ghost icon-button" id="sidebar-toggle" type="button" aria-expanded="true" aria-label="F√§ll ihop meny">
                    <span aria-hidden="true">‚ò∞</span>
                </button>
                <div id="topbar-copy">
                    <p class="eyebrow">Automatiserad annonsstudio</p>
                    <h1 id="topbar-title">Annonsgenerator</h1>
                    <p class="muted" id="topbar-subtitle">Skapa och omskriv annonser.</p>
                </div>
            </div>
            <div class="topbar__actions">
                <button class="secondary" data-view-trigger="objects">Mina objekt</button>
                <button class="primary" data-view-trigger="generator">Skapa annons</button>
            </div>
        </header>

        <div id="view-generator" class="view">
            <main class="workspace">
                <section class="panel input-panel">
                    <div class="upload-block">
                        <div class="upload-header">
                            <div>
                                <p class="eyebrow">Ladda upp filer</p>
                                <p class="muted">Bilder, planritningar eller PDF:er f√∂r AI-analys.</p>
                            </div>
                            <button class="ghost" id="upload-btn">V√§lj filer</button>
                        </div>
                        <div class="dropzone" id="dropzone">
                            <input type="file" id="file-input" multiple hidden>
                            <p>Drag & sl√§pp filer h√§r eller klicka f√∂r att ladda upp</p>
                            <div class="upload-icons">
                                <span>üñº</span><span>üìÑ</span><span>üìé</span><span>üì∑</span>
                            </div>
                        </div>
                        <div id="upload-list" class="upload-list"></div>
                    </div>

                    <header>
                        <p class="eyebrow">Fakta om bostaden</p>
                    </header>
                    <form id="listing-form" class="minimal-form">
                        <div class="field">
                            <label for="address">Adress*</label>
                            <input id="address" name="address" type="text" placeholder="Storgatan 15" required>
                        </div>
                        <div class="grid-2">
                            <div class="field">
                                <label for="neighborhood">Omr√•de</label>
                                <input id="neighborhood" name="neighborhood" type="text" placeholder="Vasastan">
                            </div>
                            <div class="field">
                                <label for="city">Stad</label>
                                <input id="city" name="city" type="text" placeholder="Stockholm">
                            </div>
                        </div>
                        <div class="grid-2">
                            <div class="field">
                                <label for="property-type">Bostadstyp</label>
                                <select id="property-type" name="property_type">
                                    <option value="l√§genhet">L√§genhet</option>
                                    <option value="villa">Villa</option>
                                    <option value="radhus">Radhus</option>
                                    <option value="parhus">Parhus</option>
                                    <option value="fritidshus">Fritidshus</option>
                                    <option value="bostad">Annat</option>
                                </select>
                            </div>
                            <div class="field">
                                <label for="rooms">Antal rum</label>
                                <input id="rooms" name="rooms" type="number" min="0" step="0.5" placeholder="3">
                            </div>
                        </div>
                        <div class="grid-2">
                            <div class="field">
                                <label for="living-area">Boarea (kvm)</label>
                                <input id="living-area" name="living_area" type="number" min="0" step="0.5" placeholder="82">
                            </div>
                            <div class="field optional" id="floor-field">
                                <label for="floor">V√•ning (f√∂r l√§genhet)</label>
                                <input id="floor" name="floor" type="text" placeholder="1">
                            </div>
                        </div>
                        <div class="grid-2">
                            <label class="checkbox">
                                <input type="checkbox" id="balcony" name="balcony"> Balkong/uteplats
                            </label>
                            <div class="field">
                                <label for="condition">Skick</label>
                                <select id="condition" name="condition">
                                    <option value="">- V√§lj -</option>
                                    <option value="Renoverad">Renoverad</option>
                                    <option value="Bra skick">Bra skick</option>
                                    <option value="Visst renoveringsbehov">Visst renoveringsbehov</option>
                                </select>
                            </div>
                        </div>
                        <div class="grid-2">
                            <div class="field optional">
                                <label for="association">F√∂reningens namn</label>
                                <input id="association" name="association" type="text" placeholder="Brf Exempel">
                            </div>
                            <div class="field optional">
                                <label for="highlights">F√∂rdelar (komma-separerat)</label>
                                <input id="highlights" name="highlights" type="text" placeholder="Balkong, L√•g avgift">
                            </div>
                        </div>
                        <div class="grid-2">
                            <div class="field">
                                <label for="tone">Ton</label>
                                <select id="tone" name="tone">
                                    <option>Neutral</option>
                                    <option>S√§ljande</option>
                                    <option>Lyxig</option>
                                    <option>Familj√§r</option>
                                    <option>Saklig</option>
                                </select>
                            </div>
                            <div class="field">
                                <label for="length">L√§ngd</label>
                                <select id="length" name="length">
                                    <option value="kort">Kort (140-180 ord)</option>
                                    <option value="normal" selected>Normal (250-300 ord)</option>
                                    <option value="l√•ng">L√•ng (350-450 ord)</option>
                                </select>
                            </div>
                        </div>
                        <div class="field">
                            <label for="style-profile">Stilprofil</label>
                            <select id="style-profile" name="style_profile_id">
                                <option value="">Standard (ingen sparad ton)</option>
                            </select>
                            <p class="muted helper-text">V√§lj en sparad ton/stilprofil f√∂r att anv√§nda kundens favoritspr√•k i genereringen.</p>
                        </div>
                        <div class="actions">
                            <button type="submit" class="primary">Generera annons</button>
                            <p id="form-message" role="status"></p>
                        </div>
                    </form>
                </section>

                <section class="panel editor" id="editor-panel">
                    <header class="editor__header">
                        <div>
                            <p class="eyebrow">Annons</p>
                            <h2 id="detail-address">Ingen annons √§n</h2>
                            <p class="muted">Texten genereras h√§r. Markera meningar och v√§lj omskrivning.</p>
                        </div>
                        <div class="editor__actions">
                            <button class="secondary" id="copy-text-btn" disabled>Kopiera text</button>
                            <button class="secondary" id="download-txt-btn" disabled>Ladda ner TXT</button>
                        </div>
                    </header>
                    <div class="editor__body">
                        <div id="detail-cover" class="detail-cover hidden" aria-live="polite"></div>
                        <div id="detail-gallery" class="detail-gallery hidden" aria-live="polite"></div>
                        <textarea id="full-editor" class="full-editor" placeholder="Generera annons f√∂r att b√∂rja" readonly></textarea>
                        <div id="ai-status" class="ai-status hidden"></div>
                        <div id="vision-insights" class="vision-insights hidden" aria-live="polite">
                            <div class="vision-insights__header">
                                <div>
                                    <p class="eyebrow">Bildanalys</p>
                                    <h3 id="vision-room">-</h3>
                                </div>
                                <span id="vision-style" class="vision-insights__style hidden"></span>
                            </div>
                            <p id="vision-summary" class="vision-insights__summary"></p>
                            <div id="vision-tags" class="vision-badges"></div>
                        </div>
                    </div>
                </section>

                <section class="panel tools" id="rewrite-panel">
                    <header>
                        <p class="eyebrow">Omskrivning</p>
                        <h2>1 klick p√• markerad text</h2>
                    </header>
                    <div class="tool-buttons">
                        <button class="chip selection-action" data-mode="rewrite">Skriv om</button>
                        <button class="chip selection-action" data-mode="sales">Mer s√§ljande</button>
                        <button class="chip selection-action" data-mode="shorter">Kortare</button>
                        <button class="chip selection-action" data-mode="simpler">Enklare spr√•k</button>
                        <button class="chip selection-action" data-mode="luxury">Lyxigare ton</button>
                        <button class="chip selection-action" data-mode="longer">L√§ngre</button>
                    </div>
                    <button class="primary" id="regenerate-btn" disabled>Generera ny variant</button>

                    <div class="versions">
                        <div class="versions__header">
                            <p class="eyebrow">Versioner</p>
                            <button class="ghost" id="clear-versions" disabled>Rensa</button>
                        </div>
                        <div id="version-list" class="version-list"></div>
                    </div>
                </section>
            </main>
        </div>
        <div id="view-vision" class="view">
            <section class="panel vision-panel">
                <div class="vision-panel__header">
                    <div>
                        <p class="eyebrow">Bildstudio</p>
                        <h2>Analysera och designa rum</h2>
                        <p class="muted">Anv√§nd Google Gemini f√∂r att tolka bilder och f√• designf√∂rslag p√• sekunder.</p>
                    </div>
                </div>
                <div class="vision-grid">
                    <article class="vision-card">
                        <h3>Analysera bild</h3>
                        <p class="muted">Klistra in en bild-URL (fr√•n t.ex. ditt mediebibliotek) f√∂r att tolka stil, rumstyp och detaljer.</p>
                        <form id="vision-analyze-form" class="vision-form">
                            <input id="vision-image-url" type="url" placeholder="https://exempel.se/bild.jpg">
                            <label class="muted small">eller ladda upp fil</label>
                            <input id="vision-image-file" type="file" accept="image/*">
                            <button type="submit" class="primary">Analysera bild</button>
                            <p id="vision-analyze-status" class="vision-status muted"></p>
                        </form>
                        <div id="vision-analyze-result" class="vision-result">
                            <p class="muted">Ingen analys √§nnu.</p>
                        </div>
                    </article>
                    <article class="vision-card vision-remix-card">
                        <h3>Designa om rummet</h3>
                        <p class="muted">Ladda upp en bild p√• ett tomt rum, v√§lj k√§nsla eller beskriv dr√∂mstilen ‚Äì AI:n f√∂resl√•r m√∂bler, f√§rger och detaljer.</p>
                        <div class="vision-remix-grid">
                            <div class="vision-remix-pane">
                                <p class="eyebrow">Utg√•ngsbild</p>
                                <label class="remix-upload" for="vision-remix-image">
                                    <input id="vision-remix-image" type="file" accept="image/*" hidden>
                                    <div id="vision-remix-preview" class="remix-preview">
                                        <p>Ladda upp eller sl√§pp en bild h√§r</p>
                                    </div>
                                    <button type="button" class="ghost">V√§lj bild</button>
                                </label>
                                <p id="vision-remix-status" class="vision-status muted"></p>
                                <div id="vision-remix-analysis" class="vision-result small">
                                    <p class="muted">Ingen bild √§nnu.</p>
                                </div>
                            </div>
                            <div class="vision-remix-pane">
                                <form id="vision-design-form" class="vision-form">
                                    <label for="vision-style">V√§lj stil</label>
                                    <select id="vision-style">
                                        <option value="Lyxigt hotellrum">Lyxigt hotellrum</option>
                                        <option value="Varmt och ombonat">Varmt och ombonat</option>
                                        <option value="Modern minimalistisk">Modern minimalistisk</option>
                                        <option value="Naturligt med tr√§ och textil">Naturligt med tr√§ och textil</option>
                                        <option value="Sval nordisk studio">Sval nordisk studio</option>
                                    </select>
                                    <label for="vision-design-prompt">Extra instruktioner</label>
                                    <textarea id="vision-design-prompt" rows="4" placeholder="Ex: L√§gg till en king size-s√§ng med hotellk√§nsla och grafiska tavlor ovanf√∂r."></textarea>
                                    <button type="submit" class="secondary">Designa rummet</button>
                                    <p id="vision-design-status" class="vision-status muted"></p>
                                </form>
                                <div id="vision-design-output" class="vision-result">
                                    <p class="muted">Inget designf√∂rslag √§nnu.</p>
                                </div>
                                <div class="vision-render">
                                    <div class="vision-render__header">
                                        <p class="eyebrow">Visualisering</p>
                                        <button type="button" class="ghost" id="vision-render-btn">Generera bild</button>
                                    </div>
                                    <p class="muted small">Anv√§nder Google Gemini f√∂r att skapa en fotorealistisk mockup av ditt rum.</p>
                                    <p id="vision-render-status" class="vision-status muted"></p>
                                    <div id="vision-render-output" class="vision-render-output">
                                        <p class="muted">Ingen bild genererad √§nnu.</p>
                                    </div>
                                    <div class="vision-render__attach">
                                        <label for="vision-render-listing" class="small muted">Koppla bild till objekt</label>
                                        <select id="vision-render-listing" aria-label="V√§lj objekt att koppla bilden till">
                                            <option value="">V√§lj objekt</option>
                                        </select>
                                        <label for="vision-render-note" class="small muted">Extra instruktioner (t.ex. ‚ÄúBeh√•ll kameravinkeln‚Äù)</label>
                                        <textarea id="vision-render-note" rows="2" placeholder="Beskriv detaljer som m√•ste bevaras: vinklar, f√∂nster, d√∂rrar..."></textarea>
                                        <button type="button" class="secondary" id="vision-render-attach" disabled>Koppla bilden</button>
                                        <p id="vision-render-link-status" class="vision-status muted"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                </div>
            </section>
        </div>

        <div id="view-annuals" class="view">
            <section class="panel annual-panel">
                <header>
                    <p class="eyebrow">Extrahera √•rsredovisningar</p>
                    <h2>Lyft BRF-nyckeltal fr√•n PDF</h2>
                    <p class="muted">Ladda upp √•rsredovisningen s√• f√•r du avgift, skulds√§ttning, planerade √•tg√§rder och risker att klistra in i objektbeskrivningen.</p>
                </header>
                <div class="annual-upload">
                    <label class="dropzone annual-drop" id="annual-drop">
                        <input type="file" id="annual-file" accept=".pdf,application/pdf" hidden>
                        <p>Sl√§pp PDF h√§r eller klicka f√∂r att v√§lja</p>
                        <div class="upload-icons">
                            <span>üìÑ</span><span>üè†</span><span>üìä</span>
                        </div>
                        <button type="button" class="ghost">V√§lj √•rsredovisning (PDF)</button>
                    </label>
                    <p id="annual-status" class="muted"></p>
                </div>
                <div id="annual-result" class="annual-result panel">
                    <p class="muted">Ingen √•rsredovisning analyserad √§nnu.</p>
                </div>
            </section>
        </div>

        <div id="view-objects" class="view view--active">
            <section class="objects-panel">
                <div class="objects-panel__header">
                    <div>
                        <p class="eyebrow">Mina objekt</p>
                        <h2>√ñversikt √∂ver annonser</h2>
                    </div>
                    <div class="objects-panel__actions">
                        <input type="search" id="object-search" placeholder="S√∂k adress, omr√•de eller stad" aria-label="S√∂k objekt">
                        <button class="ghost" id="refresh-objects" type="button">Uppdatera</button>
                    </div>
                </div>
                <div id="object-list" class="object-list">
                    <p class="empty-state">Inga objekt √§nnu. Skapa din f√∂rsta annons.</p>
                </div>
            </section>
        </div>

        <div id="view-stats" class="view">
            <section class="stat-section">
                <p class="eyebrow">Volym</p>
                <div class="stat-grid">
                    <article class="stat-card">
                        <p class="stat-card__label">Skapade annonser / vecka</p>
                        <h3 id="stat-week">0</h3>
                        <p class="muted">Senaste 7 dagarna</p>
                    </article>
                    <article class="stat-card">
                        <p class="stat-card__label">Skapade annonser / m√•nad</p>
                        <h3 id="stat-month">0</h3>
                        <p class="muted">Senaste 30 dagarna</p>
                    </article>
                    <article class="stat-card">
                        <p class="stat-card__label">Skapade annonser / totalt</p>
                        <h3 id="stat-total">0</h3>
                        <p class="muted">Alla genererade annonser</p>
                    </article>
                </div>
            </section>

            <section class="stat-section">
                <p class="eyebrow">Aktivitet & media</p>
                <div class="stat-grid">
                    <article class="stat-card">
                        <p class="stat-card__label">Omskrivningar</p>
                        <h3 id="stat-rewrites">0</h3>
                        <p class="muted">Anv√§ndningar denna vecka</p>
                    </article>
                    <article class="stat-card">
                        <p class="stat-card__label">Bearbetade bilder</p>
                        <h3 id="stat-images">0</h3>
                        <p class="muted">Analys och uppladdningar</p>
                    </article>
                    <article class="stat-card">
                        <p class="stat-card__label">Snitt bilder / objekt</p>
                        <h3 id="stat-images-avg">0.0</h3>
                        <p class="muted">Bearbetade bilder per annons</p>
                    </article>
                </div>
            </section>

            <section class="stat-section">
                <p class="eyebrow">Tidssparande</p>
                <div class="stat-grid">
                    <article class="stat-card">
                        <p class="stat-card__label">Tid sparad / annons</p>
                        <h3 id="stat-saved-avg">0 min</h3>
                        <p class="muted">J√§mf√∂rt med manuellt skrivande</p>
                    </article>
                    <article class="stat-card">
                        <p class="stat-card__label">Tid sparad / m√•nad</p>
                        <h3 id="stat-saved-month">0 h</h3>
                        <p class="muted">Senaste 30 dagarna</p>
                    </article>
                    <article class="stat-card">
                        <p class="stat-card__label">Total tid sparad</p>
                        <h3 id="stat-saved-total">0 h</h3>
                        <p class="muted">Alla genererade annonser</p>
                    </article>
                </div>
            </section>
        </div>
        <div id="view-images" class="view">
            <section class="panel">
                <p class="eyebrow">Bildhantering</p>
                <h2>Hantera bilder och filer</h2>
                <p class="muted">Ladda upp, tagga och f√∂rbered bildmaterial f√∂r annonser.</p>
                <p class="muted">Denna sektion kan fyllas med bilduploads och medie√∂versikt.</p>
            </section>
        </div>

        <div id="view-templates" class="view">
            <section class="panel">
                <p class="eyebrow">Mallar</p>
                <h2>Annonsmallar</h2>
                <p class="muted">Spara och √•teranv√§nd ton och struktur f√∂r olika m√•lgrupper.</p>
                <p class="muted">L√§gg till mallkort och knappar f√∂r att v√§lja mall.</p>
            </section>
        </div>

        <div id="view-settings" class="view">
            <section class="panel">
                <p class="eyebrow">Stilprofiler</p>
                <h2>Tr√§na tonen</h2>
                <p class="muted">L√§gg in favorittexter f√∂r varje kund s√• att Gemini kan efterlikna exakt tonfall och ordval.</p>
                <form id="profile-form" class="minimal-form">
                    <input type="hidden" id="profile-id">
                    <div class="grid-2">
                        <div class="field">
                            <label for="profile-name">Namn*</label>
                            <input id="profile-name" type="text" placeholder="Familjen Andersson" required>
                        </div>
                        <div class="field">
                            <label for="profile-tone">√ñnskad ton</label>
                            <input id="profile-tone" type="text" placeholder="Lyxig men saklig">
                        </div>
                    </div>
                    <div class="field">
                        <label for="profile-description">Beskrivning</label>
                        <textarea id="profile-description" rows="2" placeholder="N√§r anv√§nder du denna profil? Vad ska undvikas?"></textarea>
                    </div>
                    <div class="field">
                        <label for="profile-guidelines">Riktlinjer</label>
                        <textarea id="profile-guidelines" rows="2" placeholder="T.ex. 'Lyft alltid f√∂reningen', 'Inled med utsikten'"></textarea>
                    </div>
                    <div class="field">
                        <label for="profile-examples">Exempeltexter*</label>
                        <textarea id="profile-examples" rows="5" placeholder="Klistra in 2-3 favoritsnuttar, en per rad."></textarea>
                    </div>
                    <div class="field">
                        <label for="profile-forbidden">Ord att undvika</label>
                        <textarea id="profile-forbidden" rows="2" placeholder="Skriv ett ord per rad (t.ex. 'unik', 'magisk')."></textarea>
                    </div>
                    <div class="actions">
                        <button type="submit" class="primary">Spara stilprofil</button>
                        <button type="button" class="ghost" id="profile-reset">Rensa</button>
                        <p id="profile-status" class="muted" role="status"></p>
                    </div>
                </form>
                <div id="profile-list" class="profile-list">
                    <p class="muted">Inga sparade stilprofiler √§nnu.</p>
                </div>
            </section>
        </div>
    </div>

    <div id="auth-overlay" class="auth-overlay hidden" role="dialog" aria-modal="true">
        <div class="auth-card">
            <div class="auth-switch">
                <button id="auth-toggle-login" class="auth-switch__tab active" type="button">Logga in</button>
                <button id="auth-toggle-register" class="auth-switch__tab" type="button">Skapa konto</button>
            </div>
            <p id="auth-copy" class="muted">Logga in f√∂r att se dina objekt.</p>
            <p id="auth-error" class="auth-error hidden" role="alert"></p>
            <form id="login-form" class="auth-form">
                <div class="field">
                    <label for="login-email">E-post</label>
                    <input id="login-email" type="email" autocomplete="email" required placeholder="du@example.com">
                </div>
                <div class="field">
                    <label for="login-password">L√∂senord</label>
                    <input id="login-password" type="password" autocomplete="current-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button class="primary full-width" type="submit">Logga in</button>
            </form>
            <form id="register-form" class="auth-form hidden">
                <div class="field">
                    <label for="register-email">E-post</label>
                    <input id="register-email" type="email" autocomplete="email" required placeholder="du@example.com">
                </div>
                <div class="field">
                    <label for="register-password">L√∂senord</label>
                    <input id="register-password" type="password" autocomplete="new-password" required placeholder="Minst 6 tecken">
                </div>
                <button class="secondary full-width" type="submit">Skapa konto</button>
            </form>
        </div>
    </div>

    <div id="modal-overlay" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal__content">
            <div class="modal__header">
                <div>
                    <p class="eyebrow">Objekt</p>
                    <h3 id="modal-title">-</h3>
                </div>
                <button class="ghost icon-button" id="modal-close" type="button" aria-label="St√§ng">‚úï</button>
            </div>
            <div class="modal__actions">
                <button class="secondary" id="modal-copy" type="button">Kopiera text</button>
            </div>
            <div id="modal-body" class="modal__body">
                <textarea id="modal-textarea" aria-label="Objekttext" placeholder="Ingen text √§nnu."></textarea>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.7.76/build/pdf.min.js"></script>
    <script>
        if (window['pdfjsLib']) {
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@4.7.76/build/pdf.worker.min.js';
        }
    </script>
    <script src="/app.js"></script>
</body>
</html>

